# Export Schema Documentation

Last updated: 2026-02-14

## Overview

Trispr Flow supports three export formats for long-form transcription:
- **TXT**: Plain text with timestamps (human-readable)
- **Markdown (MD)**: Formatted text with sections and metadata
- **JSON**: Structured data with full metadata and programmatic access

All formats include timestamps, source attribution, and optional chapter/topic metadata.

---

## Format Specifications

### 1. Plain Text (TXT)

**Purpose**: Simple, human-readable transcript for copy/paste workflows

**Structure**:
```
Trispr Flow - Transcript Export
Date: 2026-02-14T10:30:00.000Z
Entries: 42

---

[10:30:15] Input: Hello, this is a test recording.
[10:30:22] Output: I hear you loud and clear.
[10:30:28] Input: Great, let's start the meeting.
```

**Features**:
- Header with metadata (export date, entry count)
- Chronological order (oldest to newest)
- Speaker labels: `Input` (mic) or `Output` (system audio)
- Timestamp format: `[HH:MM:SS]`

**Use cases**:
- Quick copy/paste to notes
- Email or chat sharing
- Simple archival

---

### 2. Markdown (MD)

**Purpose**: Formatted, structured transcript with sections

**Structure**:
```markdown
# Transcript Export

**Date**: 2026-02-14T10:30:00.000Z
**Total Entries**: 42

---

## Input Transcription

- **10:30:15**: Hello, this is a test recording.
- **10:30:28**: Great, let's start the meeting.

## Output Transcription

- **10:30:22** (Output): I hear you loud and clear.

---
*Generated by Trispr Flow*
```

**Features**:
- Markdown formatting (headers, lists, bold)
- Separated Input/Output sections
- Metadata in bold
- Footer attribution

**Enhanced features (v0.5.0)**:
- Chapter markers as H3 headers
- Topic tags as badges/pills
- Timestamps as anchor links (for internal navigation)

**Use cases**:
- Documentation in wikis (Notion, Obsidian, etc.)
- Meeting minutes
- Lecture notes

---

### 3. JSON

**Purpose**: Structured data for programmatic access, analysis, and interoperability

**Schema**:
```json
{
  "export_date": "2026-02-14T10:30:00.000Z",
  "format_version": "1.0",
  "entry_count": 42,
  "metadata": {
    "session_start": "2026-02-14T10:30:00.000Z",
    "session_end": "2026-02-14T11:15:00.000Z",
    "duration_ms": 2700000,
    "model": "whisper-large-v3-turbo",
    "language": "en"
  },
  "chapters": [
    {
      "id": "chapter-1",
      "label": "Introduction",
      "timestamp_ms": 1708000000000,
      "entry_count": 12,
      "topics": ["meeting", "agenda"]
    }
  ],
  "entries": [
    {
      "id": "entry-1708000015000",
      "timestamp_ms": 1708000015000,
      "timestamp": "2026-02-14T10:30:15.000Z",
      "source": "mic",
      "text": "Hello, this is a test recording.",
      "topics": ["meeting"],
      "chapter_id": "chapter-1"
    }
  ]
}
```

**Field Specifications**:

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `export_date` | ISO 8601 string | Yes | When the export was created |
| `format_version` | string | Yes | Schema version (semver) |
| `entry_count` | number | Yes | Total number of transcript entries |
| `metadata` | object | No | Session-level metadata |
| `metadata.session_start` | ISO 8601 string | No | Recording start time |
| `metadata.session_end` | ISO 8601 string | No | Recording end time |
| `metadata.duration_ms` | number | No | Total session duration in ms |
| `metadata.model` | string | No | Whisper model used |
| `metadata.language` | string | No | Detected language code |
| `chapters` | array | No | Chapter markers (v0.5.0+) |
| `chapters[].id` | string | Yes | Unique chapter ID |
| `chapters[].label` | string | Yes | Chapter name/title |
| `chapters[].timestamp_ms` | number | Yes | Chapter start time (Unix ms) |
| `chapters[].entry_count` | number | Yes | Entries in this chapter |
| `chapters[].topics` | string[] | No | Detected topics for chapter |
| `entries` | array | Yes | Transcript entries |
| `entries[].id` | string | Yes | Unique entry ID |
| `entries[].timestamp_ms` | number | Yes | Entry timestamp (Unix ms) |
| `entries[].timestamp` | ISO 8601 string | Yes | Human-readable timestamp |
| `entries[].source` | string | Yes | Entry source: `mic`, `output`, `system` |
| `entries[].text` | string | Yes | Transcribed text |
| `entries[].topics` | string[] | No | Detected topics (v0.5.0+) |
| `entries[].chapter_id` | string | No | Associated chapter ID (v0.5.0+) |

**Enhanced features (v0.5.0)**:
- `chapters` array for chapter markers
- `topics` array per entry and per chapter
- `metadata` object for session-level data
- `chapter_id` foreign key linking entries to chapters

**Use cases**:
- API integrations
- Data analysis (sentiment, keywords, etc.)
- Import to other tools (Descript, Otter.ai, etc.)
- Machine learning training data

---

## Chapter Schema (v0.5.0)

Chapters segment long-form transcripts into logical sections.

**Detection Methods**:
1. **Silence-based**: Detect long pauses (>2s silence)
2. **Time-based**: Fixed intervals (e.g., every 5 minutes)
3. **Manual**: User-defined markers

**Chapter Object**:
```typescript
interface Chapter {
  id: string;              // Unique ID (e.g., "chapter-1")
  label: string;           // Display name (e.g., "Introduction")
  timestamp_ms: number;    // Start time (Unix milliseconds)
  entry_count: number;     // Number of entries in chapter
  topics?: string[];       // Detected topics (optional)
}
```

**Example**:
```json
{
  "id": "chapter-manual-1708000000000",
  "label": "Project Planning",
  "timestamp_ms": 1708000000000,
  "entry_count": 15,
  "topics": ["technical", "meeting"]
}
```

---

## Topic Schema (v0.5.0)

Topics categorize transcript content based on keyword detection.

**Default Topics**:
- **technical**: code, debug, error, function, variable, api, database
- **meeting**: meeting, discuss, agenda, action, deadline, responsible
- **personal**: personal, note, reminder, todo, follow-up

**Topic Keywords Object**:
```typescript
interface TopicKeywords {
  [topicName: string]: string[];  // Topic name â†’ keyword array
}
```

**Example**:
```json
{
  "technical": ["code", "debug", "error", "function"],
  "meeting": ["meeting", "discuss", "agenda"],
  "personal": ["note", "reminder", "todo"]
}
```

**Detection**: Case-insensitive word boundary matching (`\bkeyword\b`)

---

## Export File Naming Convention

**Pattern**: `trispr-flow-export-{YYYY-MM-DD}-{HHMMSS}.{ext}`

**Examples**:
- `trispr-flow-export-2026-02-14-103000.txt`
- `trispr-flow-export-2026-02-14-103000.md`
- `trispr-flow-export-2026-02-14-103000.json`

**Rationale**:
- Sortable by date/time
- Clear branding (trispr-flow)
- Avoid filename conflicts

---

## Migration Path (v0.5.0)

**Current schema** (v1.0): Basic entries with timestamps and source
**Enhanced schema** (v1.1): Adds chapters, topics, metadata

**Backward compatibility**:
- v1.0 exports remain valid
- v1.1 adds optional fields (chapters, topics, metadata)
- Old exports can be imported without chapters/topics

**Version detection**:
```json
{
  "format_version": "1.1",
  ...
}
```

---

## Implementation Notes

### Export Performance

**Optimization strategies**:
- Stream large exports (don't load entire history in memory)
- Use background workers for JSON serialization
- Throttle exports (prevent spam/abuse)

**Size limits**:
- TXT/MD: ~10 MB practical limit (text editor friendly)
- JSON: ~50 MB (structured data, handles larger files)

### Character Encoding

- **UTF-8** for all formats
- BOM optional (not required)
- Line endings: LF (`\n`) preferred, CRLF (`\r\n`) accepted

### Timestamp Precision

- Internal storage: Unix milliseconds (`timestamp_ms`)
- Display format: ISO 8601 with milliseconds
- Human format: `HH:MM:SS` (no milliseconds for readability)

---

## Future Enhancements

**Potential additions** (post-v0.5.0):
- **SRT/VTT export**: Subtitle formats for video sync
- **DOCX export**: Microsoft Word format
- **PDF export**: Formatted PDF with chapters/topics
- **Custom templates**: User-defined export templates
- **Compression**: ZIP/GZIP for large exports
- **Speaker diarization**: Multiple speakers per entry (v0.6.0 VibeVoice-ASR)

---

## References

- [Whisper Output Formats](https://github.com/openai/whisper/blob/main/whisper/transcribe.py)
- [OpenAI Speech-to-Text API](https://platform.openai.com/docs/guides/speech-to-text)
- [Descript Export Guide](https://help.descript.com/hc/en-us/articles/10255753048589)
- [ISO 8601 Timestamp Format](https://en.wikipedia.org/wiki/ISO_8601)
