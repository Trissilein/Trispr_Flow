# v0.5.0 Implementation Plan - Long-Form Features + Tab-Based UI

Last updated: 2026-02-15

## Overview

v0.5.0 delivers two major improvements:

1. **Long-Form Features**: Transcript export (TXT/MD/JSON), chapter segmentation, topic detection, live transcript dump
2. **Tab-Based UI Refactor**: Restructure the entire application into a two-tab layout (Transcription + Settings) to reduce visual overload

## Current Status

### Completed (Block A - Haiku Sprint)
- âœ… Export formats researched and validated (TXT, MD, JSON)
- âœ… Export schema designed and documented (format_version 1.0)
- âœ… Export format selector UI component implemented
- âœ… Tauri `save_transcript` command implemented with file dialog
- âœ… Unit tests for all export formats (28 tests passing)
- âœ… Export feature documentation (EXPORT_GUIDE.md + EXPORT_SCHEMA.md)
- âœ… Chapter generation algorithms (silence-based, time-based, hybrid)
- âœ… Topic detection engine (keyword-based with word boundary matching)
- âœ… Search & filter functionality with highlighting

### In Progress (Block B - Sonnet Sprint)
- ğŸ”„ Tab-Based UI Refactor (major UX improvement)
- ğŸ”„ Chapter UI integration (conversation-only, settings-driven)
- ğŸ”„ Naming cleanup ("Output" â†’ "System Audio")

---

## Tab-Based UI Refactor

### Problem Statement

User feedback: "Die komplette erste Seite ist Ã¼berladen." The current single-page layout shows all settings panels alongside the transcript output, overwhelming users with 6 collapsible panels. Most settings are "fire and forget" â€” configured once, then rarely touched.

### Design

**Two top-level tabs** replacing the current single-page layout:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Hero (status indicators, model info, toggles)   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [â— Transcription]  [ Settings]                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚  Tab 1: Full-width transcript area              â”‚
â”‚  â”œâ”€ Tabs: Input | System Audio | Conversation   â”‚
â”‚  â”œâ”€ Export controls + Search                    â”‚
â”‚  â”œâ”€ Chapters (optional, conversation-only)      â”‚
â”‚  â””â”€ History list (full height)                  â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Hero (same as above)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ Transcription]  [â— Settings]                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ Capture Input   â”‚ System Audio Capture   â”‚    â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚ â”‚ Post-Processing                          â”‚    â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚ â”‚ Model Manager                            â”‚    â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚ â”‚ UX / UI Adjustments                      â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### UX Decisions

1. **Hero stays visible on both tabs** â€” status indicators and key toggles are always accessible
2. **Transcription tab is default** â€” this is 90% of what the user does during a session
3. **Tab state persists via localStorage** â€” remembers which tab was active
4. **Output panel gets full width on Transcription tab** â€” maximizes transcript reading area
5. **Settings tab uses existing 2-column grid** â€” Capture Input (left) + System Audio Capture (right), with full-width panels below

### Naming Changes

| Current | New | Reason |
|---------|-----|--------|
| Output (tab) | System Audio | Technically precise, avoids overloaded "Output" term |
| Output (panel title) | Transcription | Describes the content (transcripts) |
| Capture Output (panel) | System Audio Capture | Consistent with tab naming |

---

## Chapter Integration Plan

### Architecture Decision
Chapters are **conversation-only** by default, with optional enabling for System Audio tab.

### Settings (new fields in Settings interface)
```typescript
// Chapter settings
chapters_enabled: boolean;           // Master toggle
chapters_show_in: "conversation" | "all";  // Where to show
chapters_method: "silence" | "time" | "hybrid";  // Detection method
chapters_silence_threshold_ms: number;  // For silence-based (default: 2000)
chapters_time_interval_min: number;     // For time-based (default: 5)
```

### UI Location
- Settings â†’ new "Chapters" section (collapsible)
- Transcription tab â†’ chapters container shown conditionally based on settings

---

## Implementation Phases

### Phase 1: Tab-Based UI Refactor (Week 1-2)

**HTML Changes**:
- [ ] Add tab bar between hero and content area
- [ ] Wrap Output panel in `#tab-transcription` container
- [ ] Wrap all settings panels in `#tab-settings` container
- [ ] Rename Output tab to "System Audio"
- [ ] Rename Output panel title to "Transcription"
- [ ] Rename "Capture Output" panel to "System Audio Capture"

**TypeScript Changes**:
- [ ] Add `activeMainTab` state ("transcription" | "settings")
- [ ] Add tab switching logic with localStorage persistence
- [ ] Add DOM refs for tab buttons and containers
- [ ] Update `initPanelState()` to respect active tab
- [ ] Add `postprocessing` to panel collapse list (currently missing)

**CSS Changes**:
- [ ] Add `.main-tabs` tab bar styling
- [ ] Add `.main-tab` button styling (active/inactive states)
- [ ] Adjust `.layout-grid` for full-width on Transcription tab
- [ ] Add tab transition animations
- [ ] Ensure responsive breakpoint handles tab layout

### Phase 2: Chapter UI (Week 2-3)

- [ ] Add chapter settings fields to Settings interface (TypeScript + Rust)
- [ ] Add chapter settings UI in Settings tab
- [ ] Make chapters conditional: only show when enabled + correct tab
- [ ] Add chapter method selector to Settings (not inline in transcript)
- [ ] Connect chapter generation to settings preferences
- [ ] Test chapter persistence via backend (chapters.json already exists)

### Phase 3: Topic Integration (Week 3)

- [ ] Add topic badges to conversation view entries
- [ ] Add topic sidebar/filter in Transcription tab
- [ ] Make topics configurable in Settings tab (keyword management)

### Phase 4: Live Transcript Dump + E2E (Week 3-4)

- [ ] Implement background transcript buffering during recording
- [ ] Auto-save to disk on configurable interval
- [ ] Crash recovery from dump files
- [ ] End-to-end test: capture â†’ chapter â†’ topic â†’ export â†’ verify

---

## Technical Considerations

### Tab Switching Performance
- DOM elements stay in the DOM (hidden via `display: none`), not destroyed/recreated
- Event listeners remain wired â€” no re-initialization needed
- Only CSS visibility toggles, no JS re-rendering on tab switch

### State Impact
- No new backend state needed for tabs (frontend-only via localStorage)
- Chapter settings need backend persistence (already partially implemented in state.rs)
- Topic keywords need frontend persistence (currently in-memory only)

### Migration
- No breaking changes to settings.json schema
- New fields get defaults via Rust `Default` implementation
- Old installations seamlessly upgrade

### Files Affected

**HTML**: `index.html` (major restructuring)
**TypeScript**:
- `src/dom-refs.ts` â€” new tab refs
- `src/event-listeners.ts` â€” tab switching events
- `src/history.ts` â€” tab naming, chapter conditions
- `src/state.ts` â€” optional tab state
- `src/types.ts` â€” Settings interface additions, MainTab type
- `src/settings.ts` â€” chapter settings rendering
- `src/chapters.ts` â€” conditional visibility logic

**CSS**: `src/styles.css` â€” tab bar, layout adjustments
**Rust**: `src-tauri/src/state.rs` â€” chapter settings fields

---

## Testing

- [ ] Tab switching works correctly (both directions)
- [ ] Settings changes persist across tab switches
- [ ] Chapter generation respects settings
- [ ] Export works from Transcription tab
- [ ] All existing tests pass after refactor
- [ ] Responsive layout works on narrow screens
- [ ] Keyboard navigation works for tabs (arrow keys, Tab key)

---

## Documentation Updates Needed

- [x] EXPORT_GUIDE.md â€” complete
- [x] EXPORT_SCHEMA.md â€” complete
- [ ] ARCHITECTURE.md â€” update with tab structure
- [ ] DECISIONS.md â€” add UX decisions
- [ ] ROADMAP.md â€” update current status
- [ ] TASK_SCHEDULE.md â€” revise Block B tasks
