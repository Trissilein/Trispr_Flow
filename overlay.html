<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Trispr Flow Overlay</title>
    <style>
      * { margin: 0; padding: 0; box-sizing: border-box; }

      body {
        margin: 0;
        overflow: hidden;
        background: transparent;
      }

      #container {
        width: 100vw;
        height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
      }

      #dot {
        position: relative;
        z-index: 2;
        width: 16px;
        height: 16px;
        border-radius: 50%;
        background: #ff3d2e;
        transition: opacity 0.12s ease-out, width 0.04s linear, height 0.04s linear;
      }

      #kitt {
        display: none;
        position: relative;
        z-index: 2;
        width: 20px;
        height: 20px;
        border-radius: 4px;
        background: #ff3d2e;
        transition: opacity 0.12s ease-out, width 0.04s linear;
      }

      #transcribe-indicator {
        position: absolute;
        z-index: 3;
        width: 10px;
        height: 10px;
        border-radius: 50%;
        border: 2px solid rgba(245, 179, 66, 0.9);
        background: rgba(245, 179, 66, 0.15);
        box-shadow: 0 0 8px rgba(245, 179, 66, 0.6);
        opacity: 0;
        transform: scale(0.8);
        transition: opacity 0.16s ease-out, transform 0.16s ease-out;
        pointer-events: none;
      }

      #container[data-state="transcribing"] #transcribe-indicator {
        opacity: 1;
        transform: scale(1);
      }

      /* KITT-specific transcribe indicator styling */
      #container[data-style="kitt"] #transcribe-indicator {
        width: 24px;
        height: 12px;
        border-radius: 3px;
        transform: scale(0.8);
      }

      #container[data-style="kitt"][data-state="transcribing"] #transcribe-indicator {
        opacity: 1;
        transform: scale(1);
      }

      #refine-indicator {
        position: absolute;
        inset: 0;
        z-index: 1;
        display: grid;
        place-items: center;
        pointer-events: none;
        opacity: 0;
        transition: opacity 0.2s ease-out;
        --refine-inner-size: 38px;
        --refine-outer-size: 56px;
        --refine-inner-border: 2px;
        --refine-outer-border: 2px;
        --refine-pulse-duration: 1150ms;
        --refine-duration-factor: 1;
        --refine-range-scale: 1;
        --refine-rgb: 110, 200, 255;
        --refine-ring-opacity-a: 0.8;
        --refine-ring-opacity-b: 0.55;
        --refine-shadow-a: 14px;
        --refine-shadow-b: 20px;
      }

      #refine-indicator::before,
      #refine-indicator::after {
        content: "";
        position: absolute;
        border-radius: 999px;
        border-style: solid;
      }

      #refine-indicator::before {
        width: calc(var(--refine-inner-size) * var(--refine-range-scale));
        height: calc(var(--refine-inner-size) * var(--refine-range-scale));
        border-width: var(--refine-inner-border);
        border-color: rgba(var(--refine-rgb), var(--refine-ring-opacity-a));
        box-shadow: 0 0 var(--refine-shadow-a) rgba(var(--refine-rgb), 0.5);
        animation: refinePulseA calc(var(--refine-pulse-duration) * var(--refine-duration-factor)) ease-out infinite;
      }

      #refine-indicator::after {
        width: calc(var(--refine-outer-size) * var(--refine-range-scale));
        height: calc(var(--refine-outer-size) * var(--refine-range-scale));
        border-width: var(--refine-outer-border);
        border-color: rgba(var(--refine-rgb), var(--refine-ring-opacity-b));
        box-shadow: 0 0 var(--refine-shadow-b) rgba(var(--refine-rgb), 0.35);
        animation: refinePulseB calc(var(--refine-pulse-duration) * var(--refine-duration-factor)) ease-out infinite;
      }

      #container[data-refining-preset="subtle"] #refine-indicator {
        --refine-inner-size: 30px;
        --refine-outer-size: 44px;
        --refine-inner-border: 1.5px;
        --refine-outer-border: 1.5px;
        --refine-duration-factor: 1.15;
        --refine-ring-opacity-a: 0.56;
        --refine-ring-opacity-b: 0.4;
        --refine-shadow-a: 10px;
        --refine-shadow-b: 14px;
      }

      #container[data-refining-preset="standard"] #refine-indicator {
        --refine-inner-size: 38px;
        --refine-outer-size: 56px;
        --refine-inner-border: 2px;
        --refine-outer-border: 2px;
        --refine-duration-factor: 1;
        --refine-ring-opacity-a: 0.8;
        --refine-ring-opacity-b: 0.55;
        --refine-shadow-a: 14px;
        --refine-shadow-b: 20px;
      }

      #container[data-refining-preset="intense"] #refine-indicator {
        --refine-inner-size: 48px;
        --refine-outer-size: 72px;
        --refine-inner-border: 2.5px;
        --refine-outer-border: 2.5px;
        --refine-duration-factor: 0.82;
        --refine-ring-opacity-a: 1;
        --refine-ring-opacity-b: 0.82;
        --refine-shadow-a: 20px;
        --refine-shadow-b: 28px;
      }

      #container[data-style="kitt"] #refine-indicator {
        --refine-inner-size: 96px;
        --refine-outer-size: 132px;
      }

      #container[data-style="kitt"] #refine-indicator::before {
        height: 22px;
        border-radius: 12px;
      }

      #container[data-style="kitt"] #refine-indicator::after {
        height: 30px;
        border-radius: 16px;
      }

      #container[data-style="kitt"][data-refining-preset="subtle"] #refine-indicator {
        --refine-inner-size: 82px;
        --refine-outer-size: 114px;
      }

      #container[data-style="kitt"][data-refining-preset="intense"] #refine-indicator {
        --refine-inner-size: 112px;
        --refine-outer-size: 148px;
      }

      #container[data-refining="on"][data-refining-enabled="true"] #refine-indicator {
        opacity: 1;
      }

      @keyframes refinePulseA {
        0% {
          transform: scale(0.78);
          opacity: 0.9;
        }
        70% {
          transform: scale(1.12);
          opacity: 0.12;
        }
        100% {
          transform: scale(1.2);
          opacity: 0;
        }
      }

      @keyframes refinePulseB {
        0% {
          transform: scale(0.62);
          opacity: 0.7;
        }
        60% {
          transform: scale(1.02);
          opacity: 0.15;
        }
        100% {
          transform: scale(1.14);
          opacity: 0;
        }
      }

      /* Dot mode (default): show dot, hide kitt */
      #container[data-style="dot"] #dot { display: block; }
      #container[data-style="dot"] #kitt { display: none; }

      /* KITT mode: show kitt, hide dot */
      #container[data-style="kitt"] #dot { display: none; }
      #container[data-style="kitt"] #kitt { display: block; }
    </style>
  </head>
  <body>
    <div id="container" data-style="dot" data-state="idle">
      <div id="dot"></div>
      <div id="kitt"></div>
      <div id="transcribe-indicator"></div>
      <div id="refine-indicator"></div>
    </div>

    <script src="overlay.js"></script>
  </body>
</html>
